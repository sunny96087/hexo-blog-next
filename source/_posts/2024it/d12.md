---
title: "[ 2024 IT éµäººè³½ DAY12 ] å¾Œç«¯é–‹ç™¼å¥½å¹«æ‰‹ï¼šå››å¤§å¥—ä»¶ä½¿ç”¨æŒ‡å—"
date: 2024-09-21 20:33:45
tags: 2024ITéµäººè³½
---


å—¨å¤§å®¶å¥½ï¼ä»Šå¤©æˆ‘å€‘è¦ä¾†èªè­˜å¹¾å€‹åœ¨å¾Œç«¯é–‹ç™¼ä¸­è¶…ç´šå¯¦ç”¨çš„å¥—ä»¶ã€‚é€™äº›å¥—ä»¶å°±åƒæ˜¯æˆ‘å€‘çš„å¾—åŠ›åŠ©æ‰‹ï¼Œèƒ½è®“æˆ‘å€‘çš„é–‹ç™¼éç¨‹è®Šå¾—æ›´åŠ é †æš¢ã€‚è®“æˆ‘å€‘ä¸€èµ·ä¾†çœ‹çœ‹å§ï¼

<!--more-->

<div class="cus-intro-box">
    <h2>æˆ¿æ±ä¸çµ¦é¤Šé¸šéµ¡ - é‚£å°±ç”¨ Nuxt + Express + MongoDB 30 å¤©å¯«ä¸€å€‹å…¨ç«¯é¸šéµ¡å°ˆæ¡ˆã€‚</h2>
    <p>æŒ‘æˆ°äººç”Ÿç¬¬ä¸€æ¬¡éµäººè³½ï¼Œå°±ä¾†å€‹ä½›å¿ƒåˆ†äº« side projectï¼Œå¾å°ˆæ¡ˆç™¼æƒ³ã€è¦åŠƒã€è¨­è¨ˆã€è³‡æ–™åº«ã€é–‹ç™¼åˆ°éƒ¨ç½²ï¼ŒæŠ€è¡“ä½¿ç”¨ Nuxt 3ã€Tailwind CSSã€Piniaã€Axiosã€Expressã€MongoDBï¼Œè£½ä½œä¸€å€‹å‰å¾Œç«¯åˆ†é›¢çš„é¸šéµ¡å°ˆæ¡ˆï¼ŒåŠŸèƒ½ä¸»è¦ä»‹ç´¹é£Ÿç‰©è¨ˆç®—æ©Ÿå’Œè¯çµ¡æˆ‘å€‘ï¼Œå¸Œæœ›å¯ä»¥è®“æ›´å¤šäººç­è§£å°ˆæ¡ˆçš„å®Œæ•´æµç¨‹ âœ¨</p>
    <a href="https://ithelp.ithome.com.tw/users/20159686/ironman/7564" target="_blank">IT å…¨æ–‡ç« é€£çµ</a>
</div>

## 1. corsï¼šè·¨ä¾†æºè³‡æºå…±ç”¨çš„å®ˆé–€å“¡

### ä»€éº¼æ˜¯ corsï¼Ÿ

CORSï¼ˆCross-Origin Resource Sharingï¼‰æ˜¯ä¸€ç¨®å®‰å…¨æ©Ÿåˆ¶ï¼Œç”¨æ–¼æ§åˆ¶ç¶²é å¾ä¸åŒæºï¼ˆç¶²åŸŸï¼‰å­˜å–è³‡æºçš„æ¬Šé™ã€‚æƒ³åƒä¸€ä¸‹ï¼ŒCORS å°±åƒæ˜¯ä¸€å€‹ç²¾æ˜çš„é–€è¡›ï¼Œæ±ºå®šå“ªäº›è¨ªå®¢å¯ä»¥é€²å…¥ä½ çš„ç¶²ç«™å¾Œé™¢ã€‚

### ç‚ºä»€éº¼éœ€è¦å®ƒï¼Ÿ

åœ¨ç¾ä»£ç¶²é é–‹ç™¼ä¸­ï¼Œå‰ç«¯å’Œå¾Œç«¯ç¶“å¸¸éƒ¨ç½²åœ¨ä¸åŒçš„ç¶²åŸŸä¸Šã€‚å¦‚æœæ²’æœ‰ CORSï¼Œç€è¦½å™¨æœƒå‡ºæ–¼å®‰å…¨è€ƒæ…®ï¼Œé˜»æ­¢å‰ç«¯å‘ä¸åŒç¶²åŸŸçš„å¾Œç«¯ç™¼é€è«‹æ±‚ã€‚é€™å°±åƒæ˜¯å…©å€‹ä¸åŒåœ‹å®¶çš„äººæƒ³è¦é€šè©±ï¼Œä½†æ˜¯æ²’æœ‰åœ‹éš›é›»è©±æœå‹™ä¸€æ¨£ã€‚CORS å°±æ˜¯é‚£å€‹è®“æˆ‘å€‘èƒ½å¤ é€²è¡Œã€Œåœ‹éš›é€šè©±ã€çš„æœå‹™ã€‚

### å¦‚ä½•ä½¿ç”¨ï¼š

ä½¿ç”¨ CORS éå¸¸ç°¡å–®ï¼Œè®“æˆ‘å€‘ä¸€æ­¥æ­¥ä¾†ï¼š
1. é¦–å…ˆï¼Œæˆ‘å€‘éœ€è¦å®‰è£ CORS å¥—ä»¶ï¼š
    ```
    npm install cors
    ```
2. ç„¶å¾Œï¼Œåœ¨æˆ‘å€‘çš„ `app.js` æª”æ¡ˆä¸­è¨­å®šï¼š
é€™æ¨£è¨­å®šå¾Œï¼Œæ‰€æœ‰ä¾†æºçš„è«‹æ±‚éƒ½æœƒè¢«å…è¨±ï¼Œå°±åƒæ˜¯çµ¦äº†æ‰€æœ‰äººé€²å…¥ä½ å¾Œé™¢çš„é€šè¡Œè­‰ã€‚
    ```jsx
    const cors = require('cors');// å¼•å…¥ CORS å¥—ä»¶
    const app = express();
    app.use(cors());// å…è¨±æ‰€æœ‰ä¾†æºçš„è«‹æ±‚
    ``` 
3. å¦‚æœä½ æƒ³è¦æ›´åš´æ ¼çš„æ§åˆ¶ï¼Œå¯ä»¥é€™æ¨£è¨­å®šï¼š
é€™æ¨£å°±åƒæ˜¯ä½ å‘Šè¨´é–€è¡›ï¼šã€Œåªæœ‰ä¾†è‡ª 'http://yourfrontend.com' çš„è¨ªå®¢å¯ä»¥é€²ä¾†ï¼Œè€Œä¸”ä»–å€‘åªèƒ½ç”¨èµ°çš„æˆ–è·‘çš„æ–¹å¼é€²å…¥ï¼ˆGET å’Œ POSTï¼‰ã€‚ã€
    ```jsx
    app.use(cors({
      origin: 'http://yourfrontend.com',// åªå…è¨±é€™å€‹ç¶²åŸŸçš„è«‹æ±‚
      methods: ['GET', 'POST']// åªå…è¨± GET å’Œ POST è«‹æ±‚
    }));
    ```
    > ğŸ’¡ è¨»è§£èªªæ˜ï¼š
        - **origin:**
            é€™å€‹åƒæ•¸ç”¨ä¾†è¨­ç½®å…è¨±çš„å‰ç«¯ä¾†æºã€‚åªæœ‰ä¾†è‡ªé€™å€‹æŒ‡å®šä¾†æºçš„è«‹æ±‚æ‰æœƒé€šé CORS æª¢æŸ¥ã€‚å¦‚æœä½ æƒ³é™åˆ¶åªæœ‰ç‰¹å®šçš„ç¶²ç«™æˆ–æ‡‰ç”¨ç¨‹åºèƒ½å¤ è¨ªå•ä½ çš„ APIï¼Œé€™è£¡å°±å¯ä»¥æŒ‡å®šè©²ç¶²ç«™çš„ URLã€‚    
        - **methods:**
            é€™å€‹åƒæ•¸æŒ‡å®šäº†å…è¨±çš„ HTTP æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œé€™è£¡çš„é…ç½®åƒ…å…è¨± GET å’Œ POST è«‹æ±‚ã€‚å¦‚æœä½ çš„ API åƒ…æ”¯æŒé€™å…©ç¨®æ–¹æ³•ï¼Œå…¶ä»–æ–¹æ³•çš„è«‹æ±‚å°‡è¢«æ‹’çµ•ã€‚é€™æ¨£å¯ä»¥é˜²æ­¢å…¶ä»–é¡å‹çš„è«‹æ±‚ï¼ˆå¦‚ PUTã€DELETEï¼‰è¢«ä¸æ­£ç•¶ä½¿ç”¨ã€‚

## 2. dotenvï¼šç’°å¢ƒè®Šæ•¸çš„ç®¡å®¶

### ä»€éº¼æ˜¯ dotenvï¼Ÿ
dotenv å°±åƒæ˜¯ä¸€å€‹ç¥å¥‡çš„ä¿éšªç®±ï¼Œå¯ä»¥å®‰å…¨åœ°å­˜æ”¾æˆ‘å€‘çš„ç§˜å¯†ï¼ˆç’°å¢ƒè®Šæ•¸ï¼‰ï¼Œä¸¦åœ¨éœ€è¦æ™‚è¼•é¬†å–ç”¨ã€‚å®ƒèƒ½å¤ å°‡å­˜å„²åœ¨ `.env` æª”æ¡ˆä¸­çš„ç’°å¢ƒè®Šæ•¸è¼‰å…¥åˆ° `process.env` ä¸­ã€‚

### ç‚ºä»€éº¼éœ€è¦å®ƒï¼Ÿ
åœ¨é–‹ç™¼éç¨‹ä¸­ï¼Œæˆ‘å€‘ç¶“å¸¸éœ€è¦ä½¿ç”¨ä¸€äº›æ•æ„Ÿè³‡è¨Šï¼Œæ¯”å¦‚è³‡æ–™åº«å¯†ç¢¼æˆ– API é‡‘é‘°ã€‚æŠŠé€™äº›ç›´æ¥å¯«åœ¨ç¨‹å¼ç¢¼è£¡æ˜¯å¾ˆå±éšªçš„ï¼Œå°¤å…¶æ˜¯ç•¶ä½ çš„ç¨‹å¼ç¢¼æœƒè¢«åˆ†äº«æˆ–å…¬é–‹æ™‚ã€‚dotenv è®“æˆ‘å€‘å¯ä»¥æŠŠé€™äº›æ•æ„Ÿè³‡è¨Šå®‰å…¨åœ°å­˜æ”¾åœ¨ `.env` æª”æ¡ˆä¸­ï¼Œæ—¢æ–¹ä¾¿ç®¡ç†åˆå®‰å…¨ã€‚

### å¦‚ä½•ä½¿ç”¨ï¼š
è®“æˆ‘å€‘ä¸€æ­¥æ­¥ä¾†è¨­å®š dotenvï¼š
1. é¦–å…ˆå®‰è£ dotenvï¼š
    ```
    npm install dotenv
    ```
2. åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„å‰µå»ºä¸€å€‹ `config.env` æª”æ¡ˆï¼š
    é€™å°±åƒæ˜¯åœ¨ä¿éšªç®±è£¡æ”¾å…¥æˆ‘å€‘çš„ç§˜å¯†ã€‚
    ```
    DB_HOST=localhost
    DB_USER=root
    DB_PASS=s1mpl3
    ```
    ![https://ithelp.ithome.com.tw/upload/images/20240921/20159686ab47g8lt4T.png](https://ithelp.ithome.com.tw/upload/images/20240921/20159686ab47g8lt4T.png)
    
    > ğŸ’¡ èªªæ˜ï¼šç’°å¢ƒè®Šæ•¸æª”æ¡ˆä¸­çš„ Key-Value Pairï¼ˆéµå€¼å°ï¼‰
        åœ¨ç’°å¢ƒè®Šæ•¸æª”æ¡ˆï¼ˆä¾‹å¦‚ `.env` æˆ– `config.env`ï¼‰ä¸­ï¼Œè®Šæ•¸æ˜¯ä»¥ **Key-Value Pairï¼ˆéµå€¼å°ï¼‰** çš„å½¢å¼è¡¨ç¤ºçš„ã€‚é€™ç¨®æ ¼å¼å¹«åŠ©æˆ‘å€‘è¼•é¬†ç®¡ç†å’Œä½¿ç”¨é…ç½®æ•¸æ“šã€‚
        ### Key-Value Pair çµæ§‹
        ```
        DB_HOST=localhost
        ```
        - **Keyï¼ˆéµï¼‰:**
            - `DB_HOST` æ˜¯é€™å€‹ç’°å¢ƒè®Šæ•¸çš„ **key**ï¼Œå®ƒæ˜¯è®Šæ•¸çš„åç¨±ï¼Œå‘Šè¨´æˆ‘å€‘é€™å€‹è®Šæ•¸ä»£è¡¨ä»€éº¼ã€‚é€šå¸¸ï¼Œkey ä½¿ç”¨å…¨å¤§å¯«å­—æ¯ä¸¦ç”¨ `_` ä¾†åˆ†éš”å–®è©ã€‚
        - **Valueï¼ˆå€¼ï¼‰:**
            - `localhost` æ˜¯é€™å€‹è®Šæ•¸çš„ **value**ï¼Œå®ƒæ˜¯é€™å€‹è®Šæ•¸çš„å…·é«”å…§å®¹ã€‚åœ¨é€™å€‹ä¾‹å­ä¸­ï¼Œ`localhost` æŒ‡çš„æ˜¯è³‡æ–™åº«çš„ä¸»æ©Ÿä½ç½®ã€‚
        ### ç‚ºä»€éº¼ä½¿ç”¨ Key-Value Pairï¼Ÿ
        - **Key** æ˜¯è®Šæ•¸çš„åç¨±ï¼Œä½ å¯ä»¥åœ¨ç¨‹å¼ä¸­é€šéé€™å€‹åç¨±ä¾†å¼•ç”¨é€™å€‹è®Šæ•¸ã€‚
        - **Value** æ˜¯è®Šæ•¸çš„å¯¦éš›å€¼ï¼Œä»£è¡¨é€™å€‹è®Šæ•¸çš„å…·é«”å…§å®¹ï¼Œæ¯”å¦‚åœ°å€ã€å¯†ç¢¼ã€æˆ–å…¶ä»–é…ç½®è³‡æ–™ã€‚
        é€™æ¨£çš„çµæ§‹è®“æˆ‘å€‘å¯ä»¥åœ¨ç¨‹å¼ä¸­éˆæ´»ä½¿ç”¨ä¸åŒçš„é…ç½®æ•¸æ“šï¼Œä¸¦ä¸”èƒ½å¤ åœ¨ä¸åŒç’°å¢ƒä¸­è¼•é¬†åˆ‡æ›é…ç½®ï¼Œè€Œä¸å¿…æ”¹å‹•ç¨‹å¼ç¢¼ã€‚
    
3. åœ¨ `app.js` ä¸­ä½¿ç”¨å’Œæ¸¬è©¦ (è¨˜å¾—è¦å°‡å°ˆæ¡ˆ `npm start` åŸ·è¡Œèµ·ä¾†)ï¼š
é€™æ¨£ï¼Œæˆ‘å€‘å°±å¯ä»¥å®‰å…¨åœ°åœ¨ç¨‹å¼ä¸­ä½¿ç”¨é€™äº›ç’°å¢ƒè®Šæ•¸äº†ã€‚
    ```jsx
    // å°‡ .env æª”æ¡ˆä¸­çš„è®Šæ•¸è¼‰å…¥åˆ° process.env ä¸­
    const dotenv = require("dotenv");
    dotenv.config({ path: "./config.env" });
    
    console.log(process.env.DB_HOST); // å¾ process.env ä¸­è®€å–ä¸¦æ‰“å° DB_HOST è®Šæ•¸çš„å€¼ // é€™é‚Šæœƒå¾—åˆ° localhost
    ```
    ![https://ithelp.ithome.com.tw/upload/images/20240921/201596864mzj84h0Rr.png](https://ithelp.ithome.com.tw/upload/images/20240921/201596864mzj84h0Rr.png)
    
4. åˆ¥å¿˜äº†ä¿è­·ä½ çš„ç§˜å¯†ï¼å°‡ `.env` æª”æ¡ˆåŠ å…¥ `.gitignore`ï¼š
    é€™æ¨£å¯ä»¥ç¢ºä¿ä½ çš„ç§˜å¯†ä¸æœƒè¢«ä¸å°å¿ƒä¸Šå‚³åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»çµ±ä¸­ã€‚
    åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„æ–°å¢ä¸€å€‹ `.gitignore` æª”æ¡ˆï¼Œè²¼ä¸Šç¯„ä¾‹ç¨‹å¼ç¢¼ï¼š
    ```bash
    # ä¸è¦ä¸Šå‚³å¥—ä»¶åŒ…
    node_modules/
    
    # ä¸è¦ä¸Šå‚³ config.env
    config.env
    
    # ä¸è¦ä¸Šå‚³æ‰€æœ‰ .env
    *.env
    ```
    ![https://ithelp.ithome.com.tw/upload/images/20240921/20159686AFSrydiu0w.png](https://ithelp.ithome.com.tw/upload/images/20240921/20159686AFSrydiu0w.png)
    
    > ğŸ’¡ èªªæ˜
        1. **å¿½ç•¥ç‰¹å®šæª”æ¡ˆ `config.env`**
            å¦‚æœä½ æœ‰ä¸€å€‹ç‰¹å®šçš„ç’°å¢ƒè®Šæ•¸æª”æ¡ˆï¼Œå¦‚ `config.env`ï¼Œå¯ä»¥é€šéåœ¨ `.gitignore` ä¸­æ·»åŠ ä»¥ä¸‹ä¸€è¡Œä¾†å¿½ç•¥å®ƒï¼š
            ```
            config.env
            ```
        2. **å¿½ç•¥æ‰€æœ‰ `.env` çµå°¾çš„æª”æ¡ˆ**
            è‹¥è¦å¿½ç•¥æ‰€æœ‰å‰¯æª”åç‚º `.env` çš„æª”æ¡ˆï¼ˆä¾‹å¦‚ `production.env` æˆ– `development.env`ï¼‰ï¼Œå¯ä»¥æ·»åŠ ï¼š
            ```
            *.env
            ```
        é€™æ¨£è¨­ç½®å¾Œï¼Œç„¡è«–æ˜¯ç‰¹å®šçš„ `config.env` é‚„æ˜¯å…¶ä»– `.env` æª”æ¡ˆï¼Œéƒ½å°‡è¢« Git å¿½ç•¥ï¼Œä¿è­·ä½ çš„æ•æ„Ÿè³‡è¨Šä¸æœƒè¢«æ¨é€åˆ°é ç«¯ç‰ˆæœ¬åº«ã€‚
    
    > ç‰ˆæœ¬æ§åˆ¶ (github) æœƒåœ¨ä¸‹ä¸€ç¯‡è©³ç´°æ•™å­¸æ­

## 3. mongooseï¼šMongoDB çš„æœ€ä½³æ‹æª”

### ä»€éº¼æ˜¯ mongooseï¼Ÿ
Mongoose æ˜¯ä¸€å€‹ ODMï¼ˆObject Data Modelingï¼‰åº«ï¼Œå®ƒå°±åƒæ˜¯ MongoDB çš„ç§äººç¿»è­¯å®˜ã€‚å®ƒå¹«åŠ©æˆ‘å€‘ç”¨ JavaScript å°è±¡çš„æ–¹å¼ä¾†æ“ä½œ MongoDB çš„æ–‡æª”ã€‚

### ç‚ºä»€éº¼éœ€è¦å®ƒï¼Ÿ
MongoDB æœ¬èº«å°±å¾ˆå¼·å¤§ï¼Œä½† Mongoose è®“å®ƒè®Šå¾—æ›´åŠ æ˜“ç”¨ã€‚å®ƒæä¾›äº†æ¨¡å¼é©—è­‰ã€æŸ¥è©¢æ§‹å»ºç­‰åŠŸèƒ½ï¼Œè®“æˆ‘å€‘å¯ä»¥æ›´ç›´è§€ã€æ›´å®‰å…¨åœ°æ“ä½œæ•¸æ“šã€‚ä½¿ç”¨ Mongooseï¼Œæˆ‘å€‘å¯ä»¥å®šç¾©æ•¸æ“šçš„çµæ§‹ï¼Œé€™æ¨£å°±èƒ½ç¢ºä¿å­˜å…¥æ•¸æ“šåº«çš„æ•¸æ“šéƒ½æ˜¯ç¬¦åˆé æœŸçš„ã€‚

### å®‰è£ï¼š
```
npm install mongoose
```
> æˆ‘å€‘æœƒåœ¨å¾ŒçºŒçš„èª²ç¨‹ä¸­æ·±å…¥æ¢è¨å¦‚ä½•ä½¿ç”¨ Mongooseï¼Œæ•¬è«‹æœŸå¾…ï¼

## 4. uuidï¼šå”¯ä¸€è­˜åˆ¥ç¢¼ç”Ÿæˆå™¨

### ä»€éº¼æ˜¯ uuidï¼Ÿ
UUIDï¼ˆUniversally Unique Identifierï¼‰æ˜¯ä¸€å€‹ 128 ä½å…ƒçš„æ•¸å­—ï¼Œç”¨æ–¼åœ¨ç¶²è·¯ä¸­å”¯ä¸€åœ°æ¨™è­˜è³‡è¨Šã€‚æƒ³åƒå®ƒæ˜¯ä¸€å€‹è¶…ç´šé•·çš„ï¼Œå¹¾ä¹ä¸å¯èƒ½é‡è¤‡çš„åºè™Ÿã€‚

### ç‚ºä»€éº¼éœ€è¦å®ƒï¼Ÿ
åœ¨é–‹ç™¼ä¸­ï¼Œæˆ‘å€‘ç¶“å¸¸éœ€è¦ç”Ÿæˆå”¯ä¸€çš„æ¨™è­˜ç¬¦ï¼Œæ¯”å¦‚ç”¨æˆ¶ IDã€è¨‚å–®ç·¨è™Ÿç­‰ã€‚UUID ä¿è­‰äº†å³ä½¿åœ¨ä¸åŒçš„ç³»çµ±æˆ–æ™‚é–“é»ç”Ÿæˆçš„ ID ä¹Ÿä¸æœƒé‡è¤‡ï¼Œé€™åœ¨åˆ†å¸ƒå¼ç³»çµ±ä¸­ç‰¹åˆ¥æœ‰ç”¨ã€‚

### å¦‚ä½•ä½¿ç”¨ï¼š
1. å®‰è£ uuidï¼š
    ```
    npm install uuid
    ```
    
2. åœ¨ç¨‹å¼ä¸­ä½¿ç”¨ï¼š
æ¯æ¬¡èª¿ç”¨ `uuidv4()` éƒ½æœƒç”Ÿæˆä¸€å€‹æ–°çš„ã€å”¯ä¸€çš„ IDã€‚
    ```jsx
    const { v4: uuidv4 } = require('uuid');
    console.log(uuidv4()); // è¼¸å‡ºé¡ä¼¼ï¼š'1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed'
    ```
    ![https://ithelp.ithome.com.tw/upload/images/20240921/201596864o9K0EGdZB.png](https://ithelp.ithome.com.tw/upload/images/20240921/201596864o9K0EGdZB.png)

## ä»Šæ—¥ç¯„ä¾‹ç¨‹å¼ç¢¼ `app.js`
```jsx
var createError = require('http-errors');
var express = require('express');
var path = require('path');
var cookieParser = require('cookie-parser');
var logger = require('morgan');

var cors = require("cors"); // å¼•å…¥å…è¨±è·¨ç¶²åŸŸå¥—ä»¶ cors

// å°‡ .env æª”æ¡ˆä¸­çš„è®Šæ•¸è¼‰å…¥åˆ° process.env ä¸­
const dotenv = require("dotenv");
dotenv.config({ path: "./config.env" });

console.log(process.env.DB_HOST); // å¾ process.env ä¸­è®€å–ä¸¦æ‰“å° DB_HOST è®Šæ•¸çš„å€¼ // é€™é‚Šæœƒå¾—åˆ° localhost

const { v4: uuidv4 } = require('uuid');
console.log(uuidv4()); // è¼¸å‡ºé¡ä¼¼ï¼š'1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed'

var indexRouter = require('./routes/index');
var usersRouter = require('./routes/users');

var app = express();

app.use(cors()); // å…¨éƒ¨æ”¾è¡Œ

// view engine setup
app.set('views', path.join(__dirname, 'views'));
app.set('view engine', 'ejs');

app.use(logger('dev'));
app.use(express.json());
app.use(express.urlencoded({ extended: false }));
app.use(cookieParser());
app.use(express.static(path.join(__dirname, 'public')));

app.use('/', indexRouter);
app.use('/users', usersRouter);

// catch 404 and forward to error handler
app.use(function(req, res, next) {
  next(createError(404));
});

// error handler
app.use(function(err, req, res, next) {
  // set locals, only providing error in development
  res.locals.message = err.message;
  res.locals.error = req.app.get('env') === 'development' ? err : {};

  // render the error page
  res.status(err.status || 500);
  res.render('error');
});

module.exports = app;
```

é€™äº›å¥—ä»¶å°±åƒæ˜¯æˆ‘å€‘çš„è¶…ç´šè‹±é›„åœ˜éšŠï¼Œå„è‡ªæœ‰è‘—ç¨ç‰¹çš„æœ¬é ˜ï¼Œå¹«åŠ©æˆ‘å€‘æ§‹å»ºæ›´å®‰å…¨ã€æ›´æœ‰æ•ˆç‡çš„å¾Œç«¯æ‡‰ç”¨ã€‚é€éæ­£ç¢ºä½¿ç”¨å®ƒå€‘ï¼Œæˆ‘å€‘å¯ä»¥å°ˆæ³¨æ–¼é–‹ç™¼æ‡‰ç”¨çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œè€Œä¸å¿…éå¤šæ“”å¿ƒåº•å±¤çš„å¯¦ç¾ç´°ç¯€ã€‚
ä¸‹æ¬¡æˆ‘å€‘å°‡æ·±å…¥æ¢è¨å¦‚ä½•ä½¿ç”¨é€™äº›å·¥å…·æ§‹å»ºæ›´è¤‡é›œçš„å¾Œç«¯åŠŸèƒ½ï¼è¨˜ä½ï¼Œå­¸ç¿’ç·¨ç¨‹å°±åƒæ˜¯ä¸€å ´å†’éšªï¼Œæ¯ä¸€æ­¥éƒ½å……æ»¿äº†æ–°çš„ç™¼ç¾ã€‚ä¿æŒå¥½å¥‡å¿ƒï¼Œå‹‡æ–¼å˜—è©¦ï¼Œä½ ä¸€å®šæœƒæˆç‚ºå‡ºè‰²çš„é–‹ç™¼è€…ï¼åŠ æ²¹ï¼ğŸ’ªâœ¨
å¤§å®¶æœ‰æ²’æœ‰æƒ³è¦æ›´è©³ç´°è£œå……çš„éƒ¨åˆ†å‘¢ï¼Ÿæ­¡è¿åœ¨ä¸‹æ–¹ç•™è¨€åˆ†äº«å–”ï¼æˆ‘å€‘ä¸€èµ·å­¸ç¿’ã€ä¸€èµ·æˆé•·ã€‚æ˜å¤©è¦‹å•¦ï¼Œæ°æ°ï½

<br />
<hr />
<br />

> å¸Œæœ›é€™ç¯‡æ–‡ç« æœ‰å¹«åŠ©åˆ°ä½ ï¼Œè¬è¬ä½ çš„è§€çœ‹ï¼Œè‹¥æœ‰æƒ³çœ‹çš„ç³»åˆ—ä¹Ÿæ­¡è¿å‘Šè¨´æˆ‘ ğŸ˜‰