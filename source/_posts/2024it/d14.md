---
title: "[ 2024 IT éµäººè³½ DAY14 ] ä¸²æ¥å°ˆæ¡ˆèˆ‡é›²ç«¯è³‡æ–™åº«ï¼šMongoDB Atlas é€£æ¥èˆ‡ Git è¤‡ç¿’"
date: 2024-09-23 20:33:45
tags:
- 2024ITéµäººè³½
- MongoDB
- Mongoose
- é›²ç«¯è³‡æ–™åº«
- ç‰ˆæœ¬æ§ç®¡
- GitHub
---


å—¨å¤§å®¶å¥½ï¼æˆ‘æ˜¯2é­šã€‚ä»Šå¤©æˆ‘å€‘è¦é€²è¡Œä¸€å€‹é‡è¦çš„ä»»å‹™ï¼šå°‡å‰å¹¾å¤©å»ºç«‹çš„é›²ç«¯è³‡æ–™åº« MongoDB Atlas èˆ‡æˆ‘å€‘çš„å°ˆæ¡ˆé€£æ¥èµ·ä¾†ã€‚é€™å€‹æ­¥é©Ÿåœ¨å¯¦éš›é–‹ç™¼ä¸­éå¸¸å¸¸è¦‹ï¼Œè®“æˆ‘å€‘ä¸€èµ·ä¾†å­¸ç¿’å§ï¼

<!--more-->

<div class="cus-intro-box">
    <h2>æˆ¿æ±ä¸çµ¦é¤Šé¸šéµ¡ - é‚£å°±ç”¨ Nuxt + Express + MongoDB 30 å¤©å¯«ä¸€å€‹å…¨ç«¯é¸šéµ¡å°ˆæ¡ˆã€‚</h2>
    <p>æŒ‘æˆ°äººç”Ÿç¬¬ä¸€æ¬¡éµäººè³½ï¼Œå°±ä¾†å€‹ä½›å¿ƒåˆ†äº« side projectï¼Œå¾å°ˆæ¡ˆç™¼æƒ³ã€è¦åŠƒã€è¨­è¨ˆã€è³‡æ–™åº«ã€é–‹ç™¼åˆ°éƒ¨ç½²ï¼ŒæŠ€è¡“ä½¿ç”¨ Nuxt 3ã€Tailwind CSSã€Piniaã€Axiosã€Expressã€MongoDBï¼Œè£½ä½œä¸€å€‹å‰å¾Œç«¯åˆ†é›¢çš„é¸šéµ¡å°ˆæ¡ˆï¼ŒåŠŸèƒ½ä¸»è¦ä»‹ç´¹é£Ÿç‰©è¨ˆç®—æ©Ÿå’Œè¯çµ¡æˆ‘å€‘ï¼Œå¸Œæœ›å¯ä»¥è®“æ›´å¤šäººç­è§£å°ˆæ¡ˆçš„å®Œæ•´æµç¨‹ âœ¨</p>
    <a href="https://ithelp.ithome.com.tw/users/20159686/ironman/7564" target="_blank">IT å…¨æ–‡ç« é€£çµ</a>
</div>

> çŸ¥è­˜é»ï¼šMongoDB Atlas æ˜¯ä¸€å€‹é›²ç«¯è¨—ç®¡çš„ MongoDB æœå‹™ã€‚å®ƒæä¾›äº†é«˜å¯ç”¨æ€§ã€è‡ªå‹•å‚™ä»½ç­‰åŠŸèƒ½ï¼Œè®“æˆ‘å€‘ä¸ç”¨ç…©æƒ±ä¼ºæœå™¨ç¶­è­·çš„å•é¡Œã€‚

## é¦–å…ˆï¼Œè®“æˆ‘å€‘æ‰“é–‹ [MongoDB Atlas](https://www.mongodb.com/zh-cn/lp/cloud/atlas/try4?utm_source=bing&utm_campaign=search_bs_pl_evergreen_atlas_core_prosp-brand_gic-null_apac-tw_ps-all_desktop_eng_lead&utm_term=mongodb%20atlas&utm_medium=cpc_paid_search&utm_ad=e&utm_ad_campaign_id=415204532&adgroup=1223756911396751&msclkid=794cc8d6b4cb1f79d943ae172f01fce1?utm_source=bing&utm_campaign=search_bs_pl_evergreen_atlas_core_prosp-brand_gic-null_apac-tw_ps-all_desktop_eng_lead&utm_term=mongodb%20atlas&utm_medium=cpc_paid_search&utm_ad=e&utm_ad_campaign_id=415204532&adgroup=1223756911396751&msclkid=794cc8d6b4cb1f79d943ae172f01fce1) çš„ç¶²é å„€è¡¨æ¿ï¼š
- é»æ“Š "Connect" é€£æ¥æŒ‰éˆ•
    ![https://ithelp.ithome.com.tw/upload/images/20240923/20159686zYJQ84e5fa.png](https://ithelp.ithome.com.tw/upload/images/20240923/20159686zYJQ84e5fa.png)
    
- é¸æ“‡ "Drivers" é€£æ¥æ–¹å¼
    ![https://ithelp.ithome.com.tw/upload/images/20240923/20159686CbQEiw0iPm.png](https://ithelp.ithome.com.tw/upload/images/20240923/20159686CbQEiw0iPm.png)
    
- æœƒé–‹å•Ÿä¸€å€‹å½ˆçª—ï¼Œå…ˆä¸è¦é—œé–‰ï¼Œç­‰ç­‰æœƒç”¨åˆ°
    ![https://ithelp.ithome.com.tw/upload/images/20240923/20159686LOQYyar9zv.png](https://ithelp.ithome.com.tw/upload/images/20240923/20159686LOQYyar9zv.png)

## æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘è¦åœ¨å°ˆæ¡ˆä¸­è¨­ç½®ç’°å¢ƒè®Šæ•¸ï¼š

- æ‰“é–‹ VS Codeï¼Œæ‰¾åˆ° `config.env` æ–‡ä»¶
- è¼¸å…¥ä»¥ä¸‹å…©å€‹ç’°å¢ƒè®Šæ•¸ï¼ˆä¹‹å‰ç¤ºç¯„çš„å¯ä»¥åˆªé™¤ï¼‰ï¼š
    ```bash
    DATABASE=mongodb+srv://test123456:<password>@cluster0.5dkg9.mongodb.net/?retryWrites=true&w=majority&appName=Cluster0
    DATABASE_PASSWORD=test123456
    ```
    `DATABASE` è²¼ä¸Šè¤‡è£½çš„ä»£ç¢¼ï¼Œ
    `DATABASE_PASSWORD` å‰‡æ˜¯è¼¸å…¥ä¹‹å‰å»ºç«‹è³‡æ–™åº«æ™‚ï¼Œå‰µå»ºç”¨æˆ¶çš„å¯†ç¢¼
    ![https://ithelp.ithome.com.tw/upload/images/20240923/20159686h8XTeyfjs9.png](https://ithelp.ithome.com.tw/upload/images/20240923/20159686h8XTeyfjs9.png)
    
    > çŸ¥è­˜é»ï¼šç’°å¢ƒè®Šæ•¸æ˜¯ä¸€ç¨®åœ¨æ‡‰ç”¨ç¨‹å¼å¤–éƒ¨è¨­ç½®é…ç½®çš„æ–¹æ³•ã€‚é€™æ¨£åšå¯ä»¥æé«˜å®‰å…¨æ€§ï¼ˆä¸ç›´æ¥åœ¨ä»£ç¢¼ä¸­æš´éœ²æ•æ„Ÿä¿¡æ¯ï¼‰å’Œéˆæ´»æ€§ï¼ˆå¯ä»¥æ ¹æ“šä¸åŒç’°å¢ƒæ›´æ”¹é…ç½®ï¼‰ã€‚
- é—œé–‰é é¢å½ˆçª—ï¼Œåˆ°é›†åˆé é¢æŸ¥çœ‹ä¸Šæ¬¡å»ºç«‹çš„ `Database` åç¨±ï¼ˆæˆ‘çš„ç¯„ä¾‹æ˜¯ `test`ï¼‰
    ![https://ithelp.ithome.com.tw/upload/images/20240923/20159686V4g6NccabE.png](https://ithelp.ithome.com.tw/upload/images/20240923/20159686V4g6NccabE.png)
    
- å›åˆ° vscode `config.env` å¡«å…¥å‰›å‰›ç¢ºèªå¥½çš„è³‡æ–™åº«åç¨±ï¼Œæˆ‘é€™é‚Šå¡«å…¥ `test`
    ![https://ithelp.ithome.com.tw/upload/images/20240923/20159686rEUHoO7JDc.png](https://ithelp.ithome.com.tw/upload/images/20240923/20159686rEUHoO7JDc.png)

## ç¾åœ¨ï¼Œè®“æˆ‘å€‘ä½¿ç”¨ Mongoose ä¾†å»ºç«‹é€£æ¥
- é–‹å•Ÿ app.js æª”æ¡ˆï¼Œæ·»åŠ ç¯„ä¾‹ç¨‹å¼ç¢¼ï¼Œé€²è¡Œè³‡æ–™åº«é€£æ¥
    ```jsx
    // å°å…¥ mongoose å¥—ä»¶ä½¿ç”¨
    const mongoose = require("mongoose");
    
    // å°‡ .env æª”æ¡ˆä¸­çš„è®Šæ•¸è¼‰å…¥åˆ° process.env ä¸­
    const dotenv = require("dotenv");
    dotenv.config({ path: "./config.env" });
    
    var app = express();
    
    // å®£å‘Š DB å¸¸æ•¸ï¼Œå°‡ <password> å­—ä¸²æ›¿æ›ç‚º .env æª”æ¡ˆå…§çš„ DATABASE_PASSWORD (å°±æ˜¯æˆ‘å€‘çš„è³‡æ–™åº«ç”¨æˆ¶å¯†ç¢¼)
    const DB = process.env.DATABASE.replace(
      "<password>",
      process.env.DATABASE_PASSWORD
    );
    
    // é€£æ¥è³‡æ–™åº«
    mongoose
      .connect(DB)
      .then(() => console.log("è³‡æ–™åº«é€£æ¥æˆåŠŸ")) // é€£æ¥æˆåŠŸæœƒçœ‹åˆ° log("è³‡æ–™åº«é€£æ¥æˆåŠŸ")
      .catch((err) => {
        console.log("MongoDB é€£æ¥å¤±æ•—:", err); // åä¹‹ï¼Œæ•æ‰éŒ¯èª¤ä¸¦ log é¡¯ç¤ºéŒ¯èª¤åŸå› 
      });
    ```
    ![https://ithelp.ithome.com.tw/upload/images/20240923/20159686DltMH5Qmfk.png](https://ithelp.ithome.com.tw/upload/images/20240923/20159686DltMH5Qmfk.png)
    

## è£œå……ï¼šå°‡ Mongo æ”¹æˆä»»ä½•äººéƒ½å¯ä»¥é€£æ¥ (æ²’æœ‰æ”¹çš„è©±ä¹‹å¾Œå¯èƒ½æœƒé€£ä¸ä¸Šè³‡æ–™åº«)

- æ‰“é–‹ Mongo ç¶²é ï¼Œé€²åˆ° `Network Access`
    ![https://ithelp.ithome.com.tw/upload/images/20240923/20159686f0WXgzZGZL.png](https://ithelp.ithome.com.tw/upload/images/20240923/20159686f0WXgzZGZL.png)
- é»æ“Š `Edit`ï¼Œé»æ“Š `Allow Access From Anywhere`ï¼Œçœ‹åˆ° `Access List Entry` è®Šæˆ `0.0.0.0/0` å¾Œå°±å¯ä»¥é»æ“Š `Confirm` å„²å­˜äº†
    ![https://ithelp.ithome.com.tw/upload/images/20240923/20159686bPEm4a0psK.png](https://ithelp.ithome.com.tw/upload/images/20240923/20159686bPEm4a0psK.png)
    

## æœ€å¾Œï¼Œè®“æˆ‘å€‘è¤‡ç¿’ä¸€ä¸‹ Git çš„ä½¿ç”¨ï¼Œå°‡ä»Šå¤©çš„è®Šæ›´æ¨é€åˆ°å„²å­˜åº«ï¼š

1. é—œé–‰æ­£åœ¨é‹è¡Œçš„æœå‹™ï¼ˆåœ¨çµ‚ç«¯æ©Ÿä¸­æŒ‰ Ctrl + Cï¼‰
    ![https://ithelp.ithome.com.tw/upload/images/20240923/20159686tqcRpXvUKq.png](https://ithelp.ithome.com.tw/upload/images/20240923/20159686tqcRpXvUKq.png)
2. è¼¸å…¥ä»¥ä¸‹ Git æŒ‡ä»¤ï¼š
    
    ```bash
    # å°‡ç•¶å‰ç›®éŒ„ä¸­çš„æ‰€æœ‰æª”æ¡ˆå’Œè³‡æ–™å¤¾ï¼ˆåŒ…æ‹¬è®Šæ›´ã€æ–°å¢ã€åˆªé™¤çš„æª”æ¡ˆï¼‰æ·»åŠ åˆ°æš«å­˜å€ï¼ˆstaging areaï¼‰ï¼Œæº–å‚™é€²è¡Œæäº¤ã€‚
    git add .
    
    # (éå¿…è¦) ç”¨ä¾†æŸ¥çœ‹ç›®å‰çš„å„²å­˜åº«ç‹€æ…‹ã€‚é€™æœƒé¡¯ç¤ºå“ªäº›æª”æ¡ˆå·²è¢«ä¿®æ”¹ã€å“ªäº›å·²ç¶“æš«å­˜ï¼Œä»¥åŠé‚„æœ‰å“ªäº›æª”æ¡ˆæœªè¢«è¿½è¹¤ã€‚
    git status
    
    # å°‡æš«å­˜å€ä¸­çš„è®Šæ›´æäº¤åˆ°æœ¬åœ°å„²å­˜åº«ï¼Œä¸¦é™„ä¸Šæäº¤è¨Šæ¯ Connect mongoDBã€‚é€™æ¬¡æäº¤æœƒå°‡æ‰€æœ‰è¢«æš«å­˜çš„æª”æ¡ˆè®Šæ›´è¨˜éŒ„åˆ° Git çš„æ­·å²ç´€éŒ„ä¸­ã€‚
    git commit -m 'Connect mongoDB'
    
    # å°‡æœ¬åœ°è®Šæ›´æ¨é€åˆ°é ç¨‹å„²å­˜åº«ã€‚
    git push origin master
    ```
   ![https://ithelp.ithome.com.tw/upload/images/20240923/20159686iWZJIhHU4X.png](https://ithelp.ithome.com.tw/upload/images/20240923/20159686iWZJIhHU4X.png)

é‚„æ²’å®Œå‘¢ï¼è®“æˆ‘å€‘å†ä»‹ç´¹ä¸€å€‹è¶…å¯¦ç”¨çš„å°å·¥å…·ï¼Œå®ƒèƒ½è®“æˆ‘å€‘æ›´ç›´è§€åœ°ç†è§£ Git çš„é‹ä½œã€‚

## Git Graphï¼šGit çš„è¦–è¦ºåŒ–åŠ©æ‰‹

åœ¨é–‹ç™¼éç¨‹ä¸­ï¼Œæœ‰æ™‚å€™æˆ‘å€‘å¯èƒ½æœƒæä¸æ¸…æ¥š Git åˆ†æ”¯çš„ç‹€æ…‹ã€‚é€™æ™‚å€™ï¼ŒGit Graph é€™å€‹ VS Code æ“´å……å¥—ä»¶å°±æ´¾ä¸Šç”¨å ´äº†ã€‚å®ƒèƒ½å¹«æˆ‘å€‘å°‡ Git çš„æ­·å²è¨˜éŒ„è½‰æ›æˆæ˜“æ‡‚çš„åœ–å½¢ç•Œé¢ã€‚
ä½¿ç”¨æ­¥é©Ÿï¼š
1. åœ¨ VS Code å·¦å´é¸å–®ä¸­é»æ“Šæ“´å……å¥—ä»¶åœ–æ¨™ã€‚
2. åœ¨æœå°‹æ¬„è¼¸å…¥ "Git Graph"ã€‚
3. æ‰¾åˆ° Git Graph å¥—ä»¶ä¸¦é»æ“Šã€‚
4. é»æ“Š "å®‰è£" æŒ‰éˆ•ã€‚
    ![https://ithelp.ithome.com.tw/upload/images/20240923/2015968616WAMOqX8N.png](https://ithelp.ithome.com.tw/upload/images/20240923/2015968616WAMOqX8N.png)
5. å®‰è£å®Œæˆå¾Œï¼Œä½ æœƒåœ¨ VS Code å·¦ä¸‹è§’çœ‹åˆ° Git Graph çš„åœ–æ¨™ã€‚é»æ“Šå®ƒå°±å¯ä»¥æŸ¥çœ‹è¦–è¦ºåŒ–çš„ Git æ­·å²è¨˜éŒ„äº†ã€‚
    ![https://ithelp.ithome.com.tw/upload/images/20240923/2015968666kXevDrb7.png](https://ithelp.ithome.com.tw/upload/images/20240923/2015968666kXevDrb7.png)
æœ‰äº† Git Graphï¼Œä½ å°±èƒ½è¼•é¬†æŒæ¡å°ˆæ¡ˆçš„ç‰ˆæœ¬æ­·å²ï¼Œåˆ†æ”¯çš„å‰µå»ºå’Œåˆä½µä¸€ç›®äº†ç„¶ã€‚é€™å°æ–¼ç†è§£è¤‡é›œçš„é–‹ç™¼æµç¨‹ç‰¹åˆ¥æœ‰å¹«åŠ©ã€‚

### ä»Šæ—¥ç¯„ä¾‹ç¨‹å¼ç¢¼ `app.js`

```jsx
var createError = require("http-errors");
var express = require("express");
var path = require("path");
var cookieParser = require("cookie-parser");
var logger = require("morgan");

var cors = require("cors"); // å¼•å…¥å…è¨±è·¨ç¶²åŸŸå¥—ä»¶ cors

// console.log(process.env.DB_HOST); // å¾ process.env ä¸­è®€å–ä¸¦æ‰“å° DB_HOST è®Šæ•¸çš„å€¼ // é€™é‚Šæœƒå¾—åˆ° localhost

const { v4: uuidv4 } = require("uuid");
// console.log(uuidv4()); // è¼¸å‡ºé¡ä¼¼ï¼š'1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed'

var indexRouter = require("./routes/index");
var usersRouter = require("./routes/users");

const mongoose = require("mongoose");

// å°‡ .env æª”æ¡ˆä¸­çš„è®Šæ•¸è¼‰å…¥åˆ° process.env ä¸­
const dotenv = require("dotenv");
dotenv.config({ path: "./config.env" });

var app = express();

// ? é€£æ¥è³‡æ–™åº«
const DB = process.env.DATABASE.replace(
  "<password>",
  process.env.DATABASE_PASSWORD
);

mongoose
  .connect(DB)
  .then(() => console.log("è³‡æ–™åº«é€£æ¥æˆåŠŸ"))
  .catch((err) => {
    console.log("MongoDB é€£æ¥å¤±æ•—:", err);
  });

app.use(cors()); // å…¨éƒ¨æ”¾è¡Œ

// view engine setup
app.set("views", path.join(__dirname, "views"));
app.set("view engine", "ejs");

app.use(logger("dev"));
app.use(express.json());
app.use(express.urlencoded({ extended: false }));
app.use(cookieParser());
app.use(express.static(path.join(__dirname, "public")));

app.use("/", indexRouter);
app.use("/users", usersRouter);

// catch 404 and forward to error handler
app.use(function (req, res, next) {
  next(createError(404));
});

// error handler
app.use(function (err, req, res, next) {
  // set locals, only providing error in development
  res.locals.message = err.message;
  res.locals.error = req.app.get("env") === "development" ? err : {};

  // render the error page
  res.status(err.status || 500);
  res.render("error");
});

module.exports = app;

```
> config.env ä¸æä¾›ï¼Œè«‹ä½¿ç”¨è‡ªå·±çš„è³‡æ–™åº« ğŸ˜‚

### ç¸½çµ

ä»Šå¤©æˆ‘å€‘å®Œæˆäº†å¹¾é …é‡è¦çš„ä»»å‹™ï¼š
1. å°‡æˆ‘å€‘çš„å°ˆæ¡ˆèˆ‡ MongoDB Atlas é›²ç«¯è³‡æ–™åº«é€£æ¥ã€‚
2. å­¸ç¿’äº†å¦‚ä½•ä½¿ç”¨ç’°å¢ƒè®Šæ•¸ä¾†ä¿è­·æ•æ„Ÿè³‡è¨Šã€‚
3. ä½¿ç”¨ Mongoose å»ºç«‹äº†è³‡æ–™åº«é€£æ¥ã€‚
4. è¤‡ç¿’äº† Git çš„åŸºæœ¬æ“ä½œï¼Œå°‡è®Šæ›´æ¨é€åˆ° GitHubã€‚
5. èªè­˜äº† Git Graph é€™å€‹å¼·å¤§çš„è¦–è¦ºåŒ–å·¥å…·ã€‚
é€™äº›æ­¥é©Ÿé›–ç„¶çœ‹èµ·ä¾†ä¸å°‘ï¼Œä½†æ¯ä¸€æ­¥éƒ½æ˜¯é–‹ç™¼æµç¨‹ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€ç’°ã€‚é€šéä»Šå¤©çš„å­¸ç¿’ï¼Œæˆ‘å€‘ç‚ºæ¥ä¸‹ä¾†çš„é–‹ç™¼å·¥ä½œæ‰“ä¸‹äº†å …å¯¦çš„åŸºç¤ã€‚
æ˜å¤©æˆ‘å€‘æœƒæ›´é€²ä¸€æ­¥ï¼Œæ¢ç´¢ Mongoose æ¨¡å‹çš„å®šç¾©ï¼Œå­¸ç¿’å¦‚ä½•æ’°å¯« API ä¾†èˆ‡è³‡æ–™åº«äº’å‹•ï¼Œé‚„æœƒä½¿ç”¨ Postman é€²è¡Œæ¸¬è©¦ã€‚é€™äº›éƒ½æ˜¯å¯¦éš›é–‹ç™¼ä¸­ç¶“å¸¸ç”¨åˆ°çš„æŠ€èƒ½ï¼Œç›¸ä¿¡å¤§å®¶æœƒè¦ºå¾—å¾ˆæœ‰è¶£ï¼
å¸Œæœ›ä»Šå¤©çš„å…§å®¹å°å¤§å®¶æœ‰å¹«åŠ©ã€‚è¨˜ä½ï¼Œå­¸ç¿’ç·¨ç¨‹å°±åƒçˆ¬æ¨“æ¢¯ï¼Œä¸€æ­¥ä¸€å€‹è…³å°ï¼Œæ…¢æ…¢ä¾†ä½†åˆ¥åœä¸‹è…³æ­¥ã€‚
å¤§å®¶æœ‰æ²’æœ‰æƒ³è¦æ›´è©³ç´°è£œå……çš„éƒ¨åˆ†å‘¢ï¼Ÿæ­¡è¿åœ¨ä¸‹æ–¹ç•™è¨€åˆ†äº«å–”ï¼æˆ‘å€‘ä¸€èµ·å­¸ç¿’ã€ä¸€èµ·æˆé•·ã€‚æ˜å¤©è¦‹å•¦ï¼Œæ°æ°ï½

<br />
<hr />
<br />

> å¸Œæœ›é€™ç¯‡æ–‡ç« æœ‰å¹«åŠ©åˆ°ä½ ï¼Œè¬è¬ä½ çš„è§€çœ‹ï¼Œè‹¥æœ‰æƒ³çœ‹çš„ç³»åˆ—ä¹Ÿæ­¡è¿å‘Šè¨´æˆ‘ ğŸ˜‰